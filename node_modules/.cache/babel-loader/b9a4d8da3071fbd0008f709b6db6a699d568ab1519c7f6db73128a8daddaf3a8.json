{"ast":null,"code":"import _slicedToArray from\"/Users/saipalutla/Documents/GVSU/Winter 2023/CIS 658/AudioHub/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./Player.css\";import{useEffect,useRef,useState}from\"react\";import{connect,useDispatch}from\"react-redux\";import{forwardsSvg,backwardsSvg,shuffleSvg}from\"../svg\";import{setPlayerState,selectSongById}from\"../actions\";import Progress from\"./ProgressBar\";import SongTime from\"./SongTime\";import NavBar from\"./NavBar\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Player=function Player(_ref){var selectedSongId=_ref.selectedSongId,defaultSong=_ref.defaultSong,playerState=_ref.playerState,songs=_ref.songs,selectSongById=_ref.selectSongById,volume=_ref.volume;var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),shuffled=_useState2[0],setShuffled=_useState2[1];var audioRef=useRef();var clicked=false;var spaceDownFunc=function spaceDownFunc(event){if(event.keyCode===32&&!clicked){clicked=true;document.getElementsByClassName(\"main-control\")[0].click();}};var spaceUpFunc=function spaceUpFunc(event){if(event.keyCode===32&&clicked){clicked=false;}};useEffect(function(){document.addEventListener(\"keydown\",spaceDownFunc);document.addEventListener(\"keyup\",spaceUpFunc);},[]);if(selectedSongId<0||selectedSongId>songs.length-1){selectSongById(0);}useEffect(function(){if(audioRef.current){audioRef.current.volume=volume/500;}},[volume]);var onMusicPlay=function onMusicPlay(e){e.preventDefault();if(!playerState){audioRef.current.play();dispatch({type:\"PLAYER_STATE_SELECTED\",payload:1});}else{audioRef.current.pause();dispatch({type:\"PLAYER_STATE_SELECTED\",payload:0});}};var onBackwardClick=function onBackwardClick(){if(selectedSongId>0){selectSongById(selectedSongId-1);}};var onForwardClick=function onForwardClick(){if(selectedSongId<songs.length-1){selectSongById(selectedSongId+1);}};var onTimeSeek=function onTimeSeek(e){var target=document.getElementsByClassName(\"music-timer-wrapper\")[0];var rect=target.getBoundingClientRect();var skipToPercent=(e.clientX-rect.left)/rect.right;audioRef.current.currentTime=audioRef.current.duration*skipToPercent;dispatch({type:\"SET_CURRENT_LOCATION\",payload:audioRef.current.currentTime});};useEffect(function(){dispatch({type:\"PLAYER_STATE_SELECTED\",payload:1});audioRef.current.play();// console.log(audioRef.current.duration);\ndocument.getElementById(\"focus-link\").click();window.history.pushState({},\"\",\"/\");},[selectedSongId,dispatch]);useEffect(function(){dispatch({type:\"PLAYER_STATE_SELECTED\",payload:0});audioRef.current.pause();},[dispatch]);return/*#__PURE__*/_jsxs(\"div\",{id:\"player\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"music-timer-wrapper\",onClick:onTimeSeek,children:/*#__PURE__*/_jsx(SongTime,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",id:shuffled?\"active\":null,onClick:function onClick(){setShuffled(!shuffled);// console.log(\"shuffle: \" + !shuffled);\n},children:shuffleSvg}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",onClick:onBackwardClick,children:backwardsSvg}),/*#__PURE__*/_jsx(\"div\",{className:\"main-control control\",onClick:onMusicPlay,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-\".concat(playerState?\"pause\":\"play\",\"-circle\")})}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",onClick:onForwardClick,children:forwardsSvg}),/*#__PURE__*/_jsx(Progress,{}),/*#__PURE__*/_jsxs(\"audio\",{id:\"main-track\",controls:true,src:songs[selectedSongId].url,preload:\"true\",onEnded:function onEnded(){selectSongById(shuffled?Math.round(Math.random()*songs.length):selectedSongId+1);},onLoadedMetadata:function onLoadedMetadata(){dispatch({type:\"SET_DURATION\",payload:audioRef.current.duration});setInterval(function(){dispatch({type:\"SET_CURRENT_LOCATION\",payload:audioRef.current.currentTime});},1000);},ref:audioRef,hidden:true,children:[\"Your browser does not support the\",/*#__PURE__*/_jsx(\"code\",{children:\"audio\"}),\" element.\"]})]});};var mapStateToProps=function mapStateToProps(state){return{selectedSongId:state.selectedSongId,defaultSong:state.songs[0],playerState:state.playerState,songs:state.songs,volume:state.volume};};export default connect(mapStateToProps,{setPlayerState:setPlayerState,selectSongById:selectSongById})(Player);","map":{"version":3,"names":["useEffect","useRef","useState","connect","useDispatch","forwardsSvg","backwardsSvg","shuffleSvg","setPlayerState","selectSongById","Progress","SongTime","NavBar","jsx","_jsx","jsxs","_jsxs","Player","_ref","selectedSongId","defaultSong","playerState","songs","volume","dispatch","_useState","_useState2","_slicedToArray","shuffled","setShuffled","audioRef","clicked","spaceDownFunc","event","keyCode","document","getElementsByClassName","click","spaceUpFunc","addEventListener","length","current","onMusicPlay","e","preventDefault","play","type","payload","pause","onBackwardClick","onForwardClick","onTimeSeek","target","rect","getBoundingClientRect","skipToPercent","clientX","left","right","currentTime","duration","getElementById","window","history","pushState","id","children","className","onClick","concat","controls","src","url","preload","onEnded","Math","round","random","onLoadedMetadata","setInterval","ref","hidden","mapStateToProps","state"],"sources":["/Users/saipalutla/Documents/GVSU/Winter 2023/CIS 658/AudioHub/src/components/Player.js"],"sourcesContent":["import \"./Player.css\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { connect, useDispatch } from \"react-redux\";\nimport { forwardsSvg, backwardsSvg, shuffleSvg } from \"../svg\";\nimport { setPlayerState, selectSongById } from \"../actions\";\nimport Progress from \"./ProgressBar\";\nimport SongTime from \"./SongTime\";\nimport NavBar from \"./NavBar\";\n\nconst Player = ({\n    selectedSongId,\n    defaultSong,\n    playerState,\n    songs,\n    selectSongById,\n    volume,\n}) => {\n    const dispatch = useDispatch();\n    const [shuffled, setShuffled] = useState(false);\n    const audioRef = useRef();\n    let clicked = false;\n\n    const spaceDownFunc = (event) => {\n        if (event.keyCode === 32 && !clicked) {\n            clicked = true;\n            document.getElementsByClassName(\"main-control\")[0].click();\n        }\n    };\n    const spaceUpFunc = (event) => {\n        if (event.keyCode === 32 && clicked) {\n            clicked = false;\n        }\n    };\n\n    useEffect(() => {\n        document.addEventListener(\"keydown\", spaceDownFunc);\n        document.addEventListener(\"keyup\", spaceUpFunc);\n    }, []);\n\n    if (selectedSongId < 0 || selectedSongId > songs.length - 1) {\n        selectSongById(0);\n    }\n\n    useEffect(() => {\n        if (audioRef.current) {\n            audioRef.current.volume = volume / 500;\n        }\n    }, [volume]);\n\n    const onMusicPlay = (e) => {\n        e.preventDefault();\n\n        if (!playerState) {\n            audioRef.current.play();\n            dispatch({ type: \"PLAYER_STATE_SELECTED\", payload: 1 });\n        } else {\n            audioRef.current.pause();\n            dispatch({ type: \"PLAYER_STATE_SELECTED\", payload: 0 });\n        }\n    };\n\n    const onBackwardClick = () => {\n        if (selectedSongId > 0) {\n            selectSongById(selectedSongId - 1);\n        }\n\t};\n\t\n    const onForwardClick = () => {\n        if (selectedSongId < songs.length - 1) {\n            selectSongById(selectedSongId + 1);\n        }\n\t};\n\n\tconst onTimeSeek = (e) => {\n\t\tlet target = document.getElementsByClassName(\"music-timer-wrapper\")[0];\n\n\t\tlet rect = target.getBoundingClientRect();\n\t\tlet skipToPercent = (e.clientX - rect.left) / rect.right;\n\t\taudioRef.current.currentTime = audioRef.current.duration * skipToPercent;\n\t\tdispatch({\n\t\t\ttype: \"SET_CURRENT_LOCATION\",\n\t\t\tpayload: audioRef.current.currentTime,\n\t\t});\n\t}\n\n    useEffect(() => {\n        dispatch({ type: \"PLAYER_STATE_SELECTED\", payload: 1 });\n        audioRef.current.play();\n        // console.log(audioRef.current.duration);\n        document.getElementById(\"focus-link\").click();\n        window.history.pushState({}, \"\", \"/\");\n    }, [selectedSongId, dispatch]);\n    useEffect(() => {\n        dispatch({ type: \"PLAYER_STATE_SELECTED\", payload: 0 });\n        audioRef.current.pause();\n    }, [dispatch]);\n\n    return (\n\t\t<div id=\"player\">\n\t\t\t<div className=\"music-timer-wrapper\" onClick={onTimeSeek}>\n\t\t\t\t<SongTime />\n\t\t\t</div>\n            \n            <div\n                className=\"control\"\n                id={shuffled ? `active` : null}\n                onClick={() => {\n                    setShuffled(!shuffled);\n                    // console.log(\"shuffle: \" + !shuffled);\n                }}\n            >\n                {shuffleSvg}\n            </div>\n            <div className=\"control\" onClick={onBackwardClick}>\n                {backwardsSvg}\n            </div>\n            <div className=\"main-control control\" onClick={onMusicPlay}>\n                <i\n                    className={`fas fa-${\n                        playerState ? \"pause\" : \"play\"\n                    }-circle`}\n                ></i>\n            </div>\n            <div className=\"control\" onClick={onForwardClick}>\n                {forwardsSvg}\n            </div>\n            <Progress />\n            \n\n            <audio\n                id=\"main-track\"\n                controls\n                src={songs[selectedSongId].url}\n                preload=\"true\"\n                onEnded={() => {\n                    selectSongById(\n                        shuffled\n                            ? Math.round(Math.random() * songs.length)\n                            : selectedSongId + 1\n                    );\n                }}\n                onLoadedMetadata={() => {\n                    dispatch({\n                        type: \"SET_DURATION\",\n                        payload: audioRef.current.duration,\n                    });\n\n                    setInterval(() => {\n                        dispatch({\n                            type: \"SET_CURRENT_LOCATION\",\n                            payload: audioRef.current.currentTime,\n                        });\n                    }, 1000);\n                }}\n                ref={audioRef}\n                hidden\n            >\n                Your browser does not support the\n                <code>audio</code> element.\n            </audio>\n        </div>\n    );\n};\n\nconst mapStateToProps = (state) => {\n    return {\n        selectedSongId: state.selectedSongId,\n        defaultSong: state.songs[0],\n        playerState: state.playerState,\n        songs: state.songs,\n        volume: state.volume,\n    };\n};\n\nexport default connect(mapStateToProps, { setPlayerState, selectSongById })(\n    Player\n);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}